<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
			 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		<mapper namespace="net.daum.byb.service.TBoardDao">
				<resultMap type="net.daum.byb.entities.Tboard" id="tboardMap">
						<id property="t_seq"           column="t_seq"/>
						<id property="t_id"             column="t_id"/>
						<id property="t_nickname"        column="t_nickname"/>
						<id property="t_password"  column="t_password"/>
						<id property="t_email"        column="t_email"/>
						<id property="t_title"          column="t_title"/>
						<id property="t_content"     column="t_content"/>
						<id property="t_date"         column="t_date"/>
						<id property="t_ip"             column="t_ip"/>
						<id property="t_ref"           column="t_ref"/>
						<id property="t_step"         column="t_step"/>
						<id property="t_hit"         column="t_hit"/>
						<id property="t_level"       column="t_level"/>
						<id property="t_recommend"       column="t_recommend"/>
						<id property="t_attach"		column="t_attach"/>
						<id property="t_r_seq"		column="t_r_seq"/>
						<id property="t_r_ref"		column="t_r_ref"/>
						<id property="t_r_r_seq"		column="t_r_r_seq"/>
						<id property="t_comment"		column="t_comment"/>
				</resultMap>
				<update id="updateRow" parameterType="hashMap" >
						update tboard set 
							 t_title=#{t_title},t_content=#{t_content}
							 	where t_seq=#{t_seq}
				</update>
				<select id="selectAll" resultMap="tboardMap" >
						select * from tboard where t_ref=0 order by t_ref desc
				</select>
				<insert id="insertRow" parameterType="hashMap" >
						insert into tboard (t_seq,t_email,t_nickname,t_title,t_content,t_date,t_ref,t_step,t_hit,t_level) 
						values ((select coalesce(max(t_seq)+1,1)from tboard),#{t_email},#{t_nickname},#{t_title},#{t_content},#{t_date},0,#{t_step},#{t_hit},#{t_level})
				</insert>
				<select id="selectOne" parameterType="int" resultMap="tboardMap" >
						select * from tboard where t_seq=#{t_seq}
				</select>
				<delete id="deleteRow" parameterType="hashMap"  >
						delete from tboard  where t_seq=#{t_seq}
				</delete>
				<insert id="insertRef" parameterType="hashMap" >
						insert into tboard (t_seq,t_comment,t_date,t_ref,t_r_seq) 
						values ((select coalesce(max(t_seq)+1,1)from tboard),#{t_comment},#{t_date},#{t_seq},(select coalesce(max(t_r_seq)+1,1)from tboard))
				</insert>
				<select id="selectRef" resultMap="tboardMap" >
						select * from tboard where t_ref=#{t_ref} order by t_r_seq DESC 
				</select>
				<select id="selectRefOne" resultMap="tboardMap" >
						select * from tboard where t_r_seq=#{t_r_seq}
				</select>
				<delete id="deleteRefRow" parameterType="hashMap"  >
						delete from tboard  where t_r_seq=#{t_r_seq}
				</delete>
				<update id="updateRefRow" parameterType="hashMap" >
						update tboard set t_comment-#{t_comment} where t_r_seq=#{t_r_seq}
				</update>
		</mapper>